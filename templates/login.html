<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SageAlpha.ai â€” Sign in</title>
  
  <!-- Tailwind CSS 3.x CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            sage: {
              50: '#faf5ff',
              100: '#f3e8ff',
              200: '#e9d5ff',
              300: '#d8b4fe',
              400: '#c084fc',
              500: '#a855f7',
              600: '#9333ea',
              700: '#7c3aed',
              800: '#6b21a8',
              900: '#581c87',
            },
            primary: '#8B5CF6',
          },
          fontFamily: {
            display: ['Clash Display', 'system-ui', 'sans-serif'],
            sans: ['Satoshi', 'Inter', 'system-ui', 'sans-serif'],
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
            'slide-up': 'slideUp 0.5s ease-out',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            glow: {
              '0%': { boxShadow: '0 0 20px rgba(139, 92, 246, 0.3)' },
              '100%': { boxShadow: '0 0 40px rgba(139, 92, 246, 0.6)' },
            },
            slideUp: {
              '0%': { opacity: '0', transform: 'translateY(20px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            }
          }
        }
      }
    }
  </script>
  
  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  
  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org@2.0.4"></script>
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    @import url('https://api.fontshare.com/v2/css?f[]=satoshi@400,500,700&f[]=clash-display@600,700&display=swap');
    
    body {
      font-family: 'Satoshi', 'Inter', system-ui, sans-serif;
    }
    
    /* Pastel neutral login page */
    body.login-page {
      background-color: #F6F5FF;
    }
    
    .login-card {
      background-color: #FFFFFF;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }
    
    /* Text colors for light theme */
    body.login-page .login-card {
      color: #1f2937;
    }
    
    body.login-page .login-card label {
      color: #4b5563;
    }
    
    body.login-page .login-card input {
      background-color: #f9fafb;
      border-color: #e5e7eb;
      color: #1f2937;
    }
    
    body.login-page .login-card input::placeholder {
      color: #9ca3af;
    }
    
    body.login-page h1 {
      color: #1f2937;
    }
    
    body.login-page h1 span {
      color: #8B5CF6;
    }
    
    body.login-page p {
      color: #6b7280;
    }
    
    /* Tab buttons for light theme */
    body.login-page .login-card > div:first-child {
      background-color: #f3f4f6;
    }
    
    body.login-page .login-card button[type="button"]:not([type="submit"]) {
      color: #6b7280;
    }
    
    /* Hide floating orbs on light theme */
    body.login-page .floating-orb {
      display: none;
    }
    
    /* Company logo sizing */
    .company-logo {
      width: 180px !important;
      height: auto !important;
      display: block;
      margin: 0 auto 10px auto;
    }
    
    /* Tab label visibility */
    .login-tab-label {
      color: #111111 !important;
      font-weight: 600;
    }
    
    /* Ensure inactive/disabled tab text is also visible */
    .login-tab-label[disabled],
    .login-tab-label.disabled {
      color: #555555 !important;
    }
    
    /* Enable scrolling on smaller screens */
    html,
    body {
      height: auto;
    }
    
    body.login-page {
      min-height: 100vh;
      overflow-y: auto;
    }
    
    .input-glow:focus {
      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3), 0 0 20px rgba(139, 92, 246, 0.15);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 50%, #6D28D9 100%);
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 40px rgba(139, 92, 246, 0.4);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .floating-orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(60px);
      opacity: 0.4;
      animation: float 8s ease-in-out infinite;
    }
    
    .orb-1 {
      width: 400px;
      height: 400px;
      background: #8B5CF6;
      top: -100px;
      left: -100px;
      animation-delay: 0s;
    }
    
    .orb-2 {
      width: 300px;
      height: 300px;
      background: #A855F7;
      bottom: -50px;
      right: -50px;
      animation-delay: 2s;
    }
    
    .orb-3 {
      width: 200px;
      height: 200px;
      background: #C084FC;
      top: 40%;
      right: 10%;
      animation-delay: 4s;
    }
  </style>
</head>

<body class="login-page">
  <!-- Floating Orbs Background -->
  <div class="floating-orb orb-1"></div>
  <div class="floating-orb orb-2"></div>
  <div class="floating-orb orb-3"></div>
  
  <!-- Main Container -->
  <div class="min-h-full flex items-center justify-center p-4 relative z-10"
       x-data="{ 
         showRegister: {{ 'true' if show_register else 'false' }},
         showPassword: false,
         loading: false
       }">
    
    <div class="w-full max-w-md animate-slide-up">
      <!-- Logo -->
      <div class="text-center mb-8">
        <h1 class="font-display text-3xl font-bold text-white tracking-tight">
          SageAlpha<span class="text-sage-400">.ai</span>
        </h1>
        <p class="text-sage-200/70 text-sm mt-2">
          AI-Powered Equity Research Platform
        </p>
      </div>
      
      <!-- Card -->
      <div class="login-card rounded-3xl p-8">
        
        <!-- Tab Headers -->
        <div class="flex mb-8 bg-white/5 rounded-2xl p-1">
          <button @click="showRegister = false"
                  :class="!showRegister ? 'bg-white/10 text-white shadow-lg' : 'text-sage-300 hover:text-white'"
                  class="flex-1 py-3 px-4 rounded-xl text-sm font-semibold transition-all duration-300 login-tab-label">
            Sign In
          </button>
          <button @click="showRegister = true"
                  :class="showRegister ? 'bg-white/10 text-white shadow-lg' : 'text-sage-300 hover:text-white'"
                  class="flex-1 py-3 px-4 rounded-xl text-sm font-semibold transition-all duration-300 login-tab-label">
            Create Account
          </button>
        </div>
        
        <!-- Sign In Form -->
        <form x-show="!showRegister"
              x-transition:enter="transition ease-out duration-300"
              x-transition:enter-start="opacity-0 transform -translate-x-4"
              x-transition:enter-end="opacity-100 transform translate-x-0"
              method="post" 
              action="/login"
              class="space-y-5">
          
          {% if error %}
          <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-4 text-red-200 text-sm flex items-start gap-3"
               role="alert">
            <svg class="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
            </svg>
            <span>{{ error }}</span>
          </div>
          {% endif %}

          <div>
            <label class="block text-sage-200 text-sm font-medium mb-2">Username</label>
            <input type="text" 
                   name="username" 
                   value="{{ username | default('') }}"
                   required
                   autocomplete="username"
                   class="w-full px-4 py-3.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-sage-400/50 focus:outline-none input-glow transition-all duration-300"
                   placeholder="Enter your username">
          </div>
          
          <div>
            <label class="block text-sage-200 text-sm font-medium mb-2">Password</label>
            <div class="relative">
              <input :type="showPassword ? 'text' : 'password'" 
                     name="password" 
                     required
                     autocomplete="current-password"
                     class="w-full px-4 py-3.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-sage-400/50 focus:outline-none input-glow transition-all duration-300 pr-12"
                     placeholder="Enter your password">
              <button type="button"
                      @click="showPassword = !showPassword"
                      class="absolute right-4 top-1/2 -translate-y-1/2 text-sage-400 hover:text-white transition-colors">
                <svg x-show="!showPassword" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
                <svg x-show="showPassword" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="display: none;">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- Forgot Password Link -->
          <div class="flex justify-end">
            <a href="{{ url_for('auth.forgot_password') }}"
               class="text-sage-300 hover:text-white text-sm font-medium transition-colors duration-200">
              Forgot your password?
            </a>
          </div>

          <button type="submit"
                  class="w-full btn-primary text-white font-semibold py-4 rounded-xl shadow-lg mt-6">
            Sign In
          </button>

          <!-- Social Login Buttons -->
          <div class="mt-6 space-y-3">
            <div class="relative">
              <div class="absolute inset-0 flex items-center">
                <div class="w-full border-t border-white/10"></div>
              </div>
              <div class="relative flex justify-center text-sm">
                <span class="px-2 bg-gradient-to-r from-slate-900 to-slate-800 text-sage-300/60">or continue with</span>
              </div>
            </div>

            <div class="grid grid-cols-3 gap-3">
              <!-- Google Button -->
              <a href="{{ url_for('auth.google_login') }}"
                 class="flex items-center justify-center gap-2 px-4 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-white text-sm font-medium transition-all duration-300 hover:shadow-lg">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
                  <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                  <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                  <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                  <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                </svg>
                <span class="hidden sm:inline">Google</span>
              </a>

              <!-- Microsoft Button -->
              <button disabled
                      title="Coming soon"
                      class="flex items-center justify-center gap-2 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-sage-300/40 text-sm font-medium cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
                  <rect x="1" y="1" width="10" height="10" fill="#F25022"/>
                  <rect x="13" y="1" width="10" height="10" fill="#00A4EF"/>
                  <rect x="1" y="13" width="10" height="10" fill="#7FBA00"/>
                  <rect x="13" y="13" width="10" height="10" fill="#FFB900"/>
                </svg>
                <span class="hidden sm:inline">Microsoft</span>
              </button>

              <!-- Apple Button -->
              <button disabled
                      title="Coming soon"
                      class="flex items-center justify-center gap-2 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-sage-300/40 text-sm font-medium cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                </svg>
                <span class="hidden sm:inline">Apple</span>
              </button>
            </div>
          </div>

          <!-- Demo Users Notice -->
          <div class="text-center pt-4 border-t border-white/10 mt-6">
            <p class="text-sage-300/60 text-xs">
              Demo accounts: <span class="text-sage-300">demouser</span> / 
              <span class="text-sage-300">devuser</span> / 
              <span class="text-sage-300">produser</span>
            </p>
          </div>
        </form>
        
        <!-- Register Form -->
        <form x-show="showRegister"
              x-transition:enter="transition ease-out duration-300"
              x-transition:enter-start="opacity-0 transform translate-x-4"
              x-transition:enter-end="opacity-100 transform translate-x-0"
              method="post" 
              action="/register"
              class="space-y-5"
              style="display: none;">
          
          {% if register_error %}
          <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-4 text-red-200 text-sm flex items-start gap-3"
               role="alert">
            <svg class="w-5 h-5 text-red-400 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
            </svg>
            <span>{{ register_error }}</span>
          </div>
          {% endif %}
          
          <div>
            <label class="block text-sage-200 text-sm font-medium mb-2">Username</label>
            <input type="text"
                   name="username"
                   value="{{ reg_username | default('') }}"
                   required
                   autocomplete="username"
                   class="w-full px-4 py-3.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-sage-400/50 focus:outline-none input-glow transition-all duration-300"
                   placeholder="Choose a username">
          </div>

          <div>
            <label class="block text-sage-200 text-sm font-medium mb-2">Email</label>
            <input type="email"
                   name="email"
                   value="{{ reg_email | default('') }}"
                   required
                   autocomplete="email"
                   class="w-full px-4 py-3.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-sage-400/50 focus:outline-none input-glow transition-all duration-300"
                   placeholder="you@example.com">
          </div>
          
          <div>
            <label class="block text-sage-200 text-sm font-medium mb-2">Password</label>
            <div class="relative">
              <input :type="showPassword ? 'text' : 'password'"
                     name="password"
                     required
                     autocomplete="new-password"
                     minlength="8"
                     class="w-full px-4 py-3.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-sage-400/50 focus:outline-none input-glow transition-all duration-300 pr-12"
                     placeholder="Min. 8 characters">
              <button type="button"
                      @click="showPassword = !showPassword"
                      class="absolute right-4 top-1/2 -translate-y-1/2 text-sage-400 hover:text-white transition-colors">
                <svg x-show="!showPassword" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
                <svg x-show="showPassword" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="display: none;">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
                </svg>
              </button>
            </div>
          </div>
          
          <button type="submit"
                  class="w-full btn-primary text-white font-semibold py-4 rounded-xl shadow-lg mt-6">
            Create Account
          </button>

          <!-- Social Login Buttons -->
          <div class="mt-6 space-y-3">
            <div class="relative">
              <div class="absolute inset-0 flex items-center">
                <div class="w-full border-t border-white/10"></div>
              </div>
              <div class="relative flex justify-center text-sm">
                <span class="px-2 bg-gradient-to-r from-slate-900 to-slate-800 text-sage-300/60">or continue with</span>
              </div>
            </div>

            <div class="grid grid-cols-3 gap-3">
              <!-- Google Button -->
              <a href="{{ url_for('auth.google_login') }}"
                 class="flex items-center justify-center gap-2 px-4 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-white text-sm font-medium transition-all duration-300 hover:shadow-lg">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
                  <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                  <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                  <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                  <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                </svg>
                <span class="hidden sm:inline">Google</span>
              </a>

              <!-- Microsoft Button -->
              <button disabled
                      title="Coming soon"
                      class="flex items-center justify-center gap-2 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-sage-300/40 text-sm font-medium cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
                  <rect x="1" y="1" width="10" height="10" fill="#F25022"/>
                  <rect x="13" y="1" width="10" height="10" fill="#00A4EF"/>
                  <rect x="1" y="13" width="10" height="10" fill="#7FBA00"/>
                  <rect x="13" y="13" width="10" height="10" fill="#FFB900"/>
                </svg>
                <span class="hidden sm:inline">Microsoft</span>
              </button>

              <!-- Apple Button -->
              <button disabled
                      title="Coming soon"
                      class="flex items-center justify-center gap-2 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-sage-300/40 text-sm font-medium cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                </svg>
                <span class="hidden sm:inline">Apple</span>
              </button>
            </div>
          </div>
        </form>
        
      </div>
      
      <!-- Footer -->
      <div class="text-center mt-8 text-sage-300/50 text-xs">
        <p>SageAlpha.ai v{{ APP_VERSION }} &copy; 2025</p>
      </div>
    </div>
  </div>
</body>
</html>
